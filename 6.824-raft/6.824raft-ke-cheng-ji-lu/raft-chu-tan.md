---
description: Raft初探，从一个比较大的层面看客户端与Raft集群交互的时候，Raft集群会做的一些操作
---

# Raft-初探

Raft作为一个库（Library）存在于应用程序中。

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

想象一个kv服务器构建于Raft之上，kv服务器会调用Raft的方法，两者之间会进行信息的交互。对于客户端而言，客户端只知道与其通信是一台服务器，而不是一个Raft集群。

**客户端发起请求，服务端响应**

1. 客户端发送请求到领导者的应用层，对于一个KV服务器而言可能是put或者get请求
2. 应用层接收到请求之后，会将请求发送给Raft
3. 此时领导者的Raft与集群内其他服务器进行通信，直到半数服务器将该请求加入各自日志
4. 领导者的Raft通知应用层：请求已经复制到半数的服务器了，此时应用层可以安全的执行请求
5. 响应客户端

**当操作最终commit之后**

1. 每个副本节点的Raft将操作发送给应用层
2. 应用层执行操作

> 最佳的情况是，副本节点执行的操作内容与顺序 和 leader节点执行的操作内容与顺序完全一致









